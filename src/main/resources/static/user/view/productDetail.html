<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link href="../../static/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <title>3c数码电商平台</title>
</head>
<body>
<style>
    li{
        display:block;
        float:left;
        width: 63px;
        height: 24px;
    }

</style>
<div style="background-color: #f0f0f0">
    <div class="container">

        <div id="nav"></div>

        <div style="background-color: #5a8ce4; height:400px; overflow: hidden">
            <div  id="navigation" style="width: 20%; float: left; overflow: hidden">
                <div style="background-color: #5180d4; height: 30px">
                    <span style="margin-left: 10%; line-height: 30px;color: #fff">3c商品分类</span>
                </div>
            </div>


            <div style="width: 80%; float: right">
                <div id="myCarousel" class="carousel slide">
                    <!-- 轮播（Carousel）指标 -->
                    <ol class="carousel-indicators">
                        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                        <li data-target="#myCarousel" data-slide-to="1"></li>
                        <li data-target="#myCarousel" data-slide-to="2"></li>
                    </ol>
                    <!-- 轮播（Carousel）项目 -->
                    <div class="carousel-inner">
                        <div class="item active">
                            <img style="width:100%; height: 400px" src="../../static/images/oppo_red_test.jpg">
                        </div>
                        <div class="item">
                            <img style="width:100%; height: 400px" src="../../static/images/iphonex_test.jpg" >
                        </div>
                        <div class="item">
                            <img style="width:100%; height: 400px" src="../../static/images/huawei_test.jpg">
                        </div>
                    </div>
                    <!-- 轮播（Carousel）导航 -->
                    <a class="carousel-control left" href="#myCarousel"
                       data-slide="prev">&lsaquo;</a>
                    <a class="carousel-control right" href="#myCarousel"
                       data-slide="next">&rsaquo;</a>
                </div>
            </div>
        </div>

        <h3>3C 为你推荐 TODO 暂未实现</h3>

        <div class="row" style="background-color: #f0f0f0">
            <div class="col-sm-6 col-md-3">
                <div class="thumbnail" style="margin-top: 13px">
                    <img style="width: 130px; height: 155px;margin-top: 12px" src="../../static/images/xiaomiNote3.jpg" alt="小米note3"/>
                    <div class="caption" style="text-align: center">
                        <p>小米note3 拍照美，拍人更美！</p>
                        <p style="color:#ed2441; text-align: center">
                            ￥1999
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-3">
                <div class="thumbnail" style="margin-top: 13px">
                    <img style="width: 130px; height: 155px;margin-top: 12px" src="../../static/images/xiaomiNote3.jpg" alt="小米note3"/>
                    <div class="caption" style="text-align: center">
                        <p>小米note3 拍照美，拍人更美！</p>
                        <p style="color:#ed2441; text-align: center">
                            ￥1999
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-3">
                <div class="thumbnail" style="margin-top: 13px">
                    <img style="width: 130px; height: 155px;margin-top: 12px" src="../../static/images/xiaomiNote3.jpg" alt="小米note3"/>
                    <div class="caption" style="text-align: center">
                        <p>小米note3 拍照美，拍人更美！</p>
                        <p style="color:#ed2441; text-align: center">
                            ￥1999
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-3" id="1111111">
                <div class="thumbnail" style="margin-top: 13px">
                    <img style="width: 130px; height: 155px;margin-top: 12px" src="../../static/images/xiaomiNote3.jpg" alt="小米note3"/>
                    <div class="caption" style="text-align: center">
                        <p>小米note3 拍照美，拍人更美！</p>
                        <p style="color:#ed2441; text-align: center">
                            ￥1999
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div id="column">

        </div>

    </div>
</div>
<script src="../../static/plugins/jQuery/jquery-1.12.1.min.js" type="text/javascript"></script>
<script src="../../static/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../../static/scripts/xingsu.user.topnav.js" type="text/javascript"></script>
<script src="../../static/scripts/xingsu.ajax.auth.js" type="text/javascript"></script>
<script src="../../static/scripts/xingsu.config.js" type="text/javascript"></script>
<script src="../../static/scripts/xingsu.extensions.js" type="text/javascript"></script>


<script type="text/javascript">
    $(function () {

        var $navigation = $("#navigation");             //导航索引div
        var ajaxUrl = "../../category/get_category.do?categoryId=100001";
        $ajax.ajax(ajaxUrl, null, $config.HttpVerbs.GET, function (result) {
            if(!result.success){
                console.log(result);
                return;
            }
            $.each(result.data, function (index, value) {

                //大分类 导航字符串 比如手机电脑通讯
                var navigationStr = "<div style=\"overflow: hidden; margin: 7px 7px 10px 7px;\">\n" +
                    "                <span style=\"color: #fff;\">{0}</span>\n" +
                    "                <ul style=\"list-style-type:none;\">{1}</ul>\n" +
                    "            </div>";
                //具体子分类 比如华为小米oppo
                var navigationStrItem = "<li ><span id='{1}' style='cursor: pointer; color: white'>{0}</span></li>";

                var temp = "";
                var ajaxUrl2 = "../../category/get_category.do?categoryId=" + value.id;
                $ajax.ajax(ajaxUrl2, null, $config.HttpVerbs.GET, function (result2) {
                    if(!result2.success){
                        console.log(result2);
                        return;
                    }
                    $.each(result2.data, function (index2, value2) {
                        temp += String.format(navigationStrItem, value2.name, value2.id);
                    });

                    navigationStr = String.format(navigationStr, value.name, temp);
                    $navigation.append(navigationStr);

                    $.each(result2.data, function (index2, value2) {
                        $("#" + value2.id).click(function () {
                            location.href = "itemDetail.html?categoryId=" + value2.id;
                        });
                    });

                    columnFilling(++index, value.name, value.id);
                }, {async: false});

            });

        });

        //1F 2F 3F 大分类专栏
        function columnFilling(index, name, categoryId){
            var column = "<div style=\"overflow: hidden\">\n" +
                "            <h3>" + index + "F " + name + "<span style=\"float: right; font-size: small\"><a href='../../view/itemDetail?categoryId='"+ categoryId +">更多商品></a></span></p></h3>\n" +
                "        </div>\n" +
                "        <div id='columnItem' class=\"row\" style=\"background-color: #f0f0f0\">{1}</div>\n" +
                "        </div>";
            var columnItem = "<div class=\"col-sm-6 col-md-3\">\n" +
                "                <div class=\"thumbnail\" style=\"margin-top: 13px\">\n" +
                "                    <img style=\"width: 130px; height: 155px;margin-top: 12px\" src=\"{0}\"/>\n" +
                "                    <div class=\"caption\" style=\"text-align: center\">\n" +
                "                        <p>{1}</p>\n" +
                "                        <p style=\"color:#ed2441; text-align: center\">\n" +
                "                            ￥{2}\n" +
                "                        </p>\n" +
                "                    </div>\n" +
                "                </div>\n" +
                "            </div>";

            ajaxUrl = "../../product/listByCategoryId?categoryId="+categoryId;
            $ajax.ajax(ajaxUrl, null, $config.HttpVerbs.GET, function (result) {
                if(!result.success){
                    console.log(result);
                    return;
                }
                var columnItemTemp="";
                $.each(result.data, function (index, value) {
                    var mainImage = "../../product/getImage?mainImageName=" + value.mainImage;
                    columnItemTemp += String.format(columnItem, mainImage, value.subtitle, value.price);
                });
                var columnTemp = String.format(column, index, columnItemTemp);
                $("#column").append(columnTemp);
            }, {async: false});

        }


    });

</script>
</body>
</html>